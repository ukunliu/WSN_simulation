%%
coord = [51.5108, 51.519788107578044, -0.0988, -0.08439578091555248];
coord = [51.5134, 51.5132, -0.0901, -0.0909]

lat_s = coord(1);
lat_e = coord(2);
lon_s = coord(3);
lon_e = coord(4);

%%

tx = txsite("Latitude",lat_s,"Longitude", lon_s);

rx = rxsite("Latitude", lat_s * 1.00001, "Longitude", lon_s * 1.00002);

pm = propagationModel("raytracing", ...
    "Method","sbr", ...
    "MaxNumReflections",1, ...
    "BuildingsMaterial", 'glass', ...
    "SurfaceMaterial", "concrete");

rays = raytrace(tx, rx, pm);

trace = comm.RayTracingChannel(rays{1}, tx, rx);
trace.MinimizePropagationDelay = 0;

%%
viewer = siteviewer("Buildings","chicago.osm");
%%
tx = txsite("Latitude",41.8800, ...
    "Longitude",-87.6295, ...
    "TransmitterFrequency",2.5e9);

rx = rxsite("Latitude",41.881352, ...
    "Longitude",-87.629771, ...
    "AntennaHeight",30);

pm = propagationModel("raytracing", ...
    "Method","sbr", ...
    "MaxNumReflections",1, ...
    "BuildingsMaterial", 'glass', ...
    "SurfaceMaterial", "concrete");

raytrace(tx,rx,pm) 
%%
%%
tx = txsite("Latitude",41.8800, ...
    "Longitude",-87.6295, ...
    "TransmitterFrequency",2.5e9);

rx = rxsite("Latitude",41.881352, ...
    "Longitude",-87.629771, ...
    "AntennaHeight",30);

pm = propagationModel("raytracing", ...
    "Method","sbr", ...
    "MaxNumReflections",1, ...
    "BuildingsMaterial", 'glass', ...
    "SurfaceMaterial", "concrete");

raytrace(tx,rx,pm) 
